"use strict";(self.webpackChunkavalonia_docs=self.webpackChunkavalonia_docs||[]).push([[8874],{79112:(o,n,e)=>{e.r(n),e.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"guides/platforms/windows/host-avalonia-controls-in-winforms","title":"Host Avalonia controls in Windows Forms","description":"Avalonia controls can be hosted in Windows Forms applications. This enables a step-by-step migration of existing Windows Forms applications to Avalonia.","source":"@site/docs/guides/platforms/windows/host-avalonia-controls-in-winforms.md","sourceDirName":"guides/platforms/windows","slug":"/guides/platforms/windows/host-avalonia-controls-in-winforms","permalink":"/ru/docs/guides/platforms/windows/host-avalonia-controls-in-winforms","draft":false,"unlisted":false,"editUrl":"https://github.com/AvaloniaUI/avalonia-docs/tree/main/docs/guides/platforms/windows/host-avalonia-controls-in-winforms.md","tags":[],"version":"current","lastUpdatedBy":"202420505","lastUpdatedAt":1755588461000,"frontMatter":{"id":"host-avalonia-controls-in-winforms","title":"Host Avalonia controls in Windows Forms"},"sidebar":"documentationSidebar","previous":{"title":"How To Build and Run on the iOS Simulator","permalink":"/ru/docs/guides/platforms/ios/build-and-run-your-application-on-a-simulator"},"next":{"title":"Running on Raspberry Pi","permalink":"/ru/docs/guides/platforms/rpi/running-your-app-on-a-raspberry-pi"}}');var s=e(74848),t=e(28453);const r={id:"host-avalonia-controls-in-winforms",title:"Host Avalonia controls in Windows Forms"},a="Host Avalonia controls in Windows Forms",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Step-by-step instructions",id:"step-by-step-instructions",level:2}];function d(o){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...o.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"host-avalonia-controls-in-windows-forms",children:"Host Avalonia controls in Windows Forms"})}),"\n",(0,s.jsx)(n.p,{children:"Avalonia controls can be hosted in Windows Forms applications. This enables a step-by-step migration of existing Windows Forms applications to Avalonia."}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"An exemplary Windows Forms application with Avalonia controls requires at least two projects:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"YourApp"})," Cross platform library where you put your Avalonia controls"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"YourApp.WinForms"})," Your existing Windows Forms application"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"YourApp.Desktop"})," (optional) Executable Avalonia application, required only for the Visual Studio Avalonia designer"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"As Windows Forms is only supported on Microsoft Windows, adding Avalonia controls to your app will not make it cross platform."}),"\n",(0,s.jsx)(n.h2,{id:"step-by-step-instructions",children:"Step-by-step instructions"}),"\n",(0,s.jsxs)(n.p,{children:["These instruction assume that you use Visual Studio 2022 with the Avalonia extension.\nYou can adjust the steps and leave out the ",(0,s.jsx)(n.code,{children:"YourApp.Desktop"})," project if you are using VS Code or Rider."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create both Avalonia projects","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"In Visual Studio add a new project to your solution"}),"\n",(0,s.jsxs)(n.li,{children:["Choose ",(0,s.jsx)(n.em,{children:"Avalonia C# Project"})]}),"\n",(0,s.jsxs)(n.li,{children:["Select at least ",(0,s.jsx)(n.em,{children:"Desktop"})," as target platforms"]}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.em,{children:"Create"})]}),"\n",(0,s.jsxs)(n.li,{children:["You should now have a ",(0,s.jsx)(n.code,{children:"YourApp"})," and a ",(0,s.jsx)(n.code,{children:"YourApp.Desktop"})," project in your solution"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Add references to your existing Windows Forms project","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A package reference to ",(0,s.jsx)(n.code,{children:"Avalonia.Desktop"})]}),"\n",(0,s.jsxs)(n.li,{children:["A package reference to ",(0,s.jsx)(n.code,{children:"Avalonia.Win32.Interoperability"})]}),"\n",(0,s.jsxs)(n.li,{children:["A project reference to ",(0,s.jsx)(n.code,{children:"YourApp.csproj"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Add the following lines in your ",(0,s.jsx)(n.code,{children:"Program.cs"})," before you call ",(0,s.jsx)(n.code,{children:"Application.Run()"})]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cs",children:"AppBuilder.Configure<App>()\n    .UsePlatformDetect()\n    .SetupWithoutStarting();\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsxs)(n.li,{children:["Add an ",(0,s.jsx)(n.code,{children:"WinFormsAvaloniaControlHost"})," control from the Toolbox"]}),"\n",(0,s.jsxs)(n.li,{children:["Add the following line to your form's constructor after ",(0,s.jsx)(n.code,{children:"InitializeComponent()"})]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cs",children:"winFormsAvaloniaControlHost1.Content = new MainView { DataContext = new MainViewModel() };\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Now you should see Avalonia's default main view ",(0,s.jsx)(n.em,{children:"Welcome to Avalonia"})," in your Windows Forms application."]}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"You cannot use ReactiveUI for your Windows Forms and Avalonia controls at the same time."}),(0,s.jsxs)(n.p,{children:["If you want to use it for Avalonia you must register ReactiveUI at the ",(0,s.jsx)(n.code,{children:"AppBuilder"})," with ",(0,s.jsx)(n.code,{children:".UseReactiveUI()"})," in ",(0,s.jsx)(n.code,{children:"Program.cs"}),".\nDo not include a reference to ",(0,s.jsx)(n.code,{children:"ReactiveUI.WinForms"})," otherwise interactions will not work (see ",(0,s.jsx)(n.a,{href:"https://github.com/AvaloniaUI/Avalonia/discussions/16478",children:"#16478"}),")."]})]})]})}function p(o={}){const{wrapper:n}={...(0,t.R)(),...o.components};return n?(0,s.jsx)(n,{...o,children:(0,s.jsx)(d,{...o})}):d(o)}},28453:(o,n,e)=>{e.d(n,{R:()=>r,x:()=>a});var i=e(96540);const s={},t=i.createContext(s);function r(o){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof o?o(n):{...n,...o}}),[n,o])}function a(o){let n;return n=o.disableParentContext?"function"==typeof o.components?o.components(s):o.components||s:r(o.components),i.createElement(t.Provider,{value:n},o.children)}}}]);