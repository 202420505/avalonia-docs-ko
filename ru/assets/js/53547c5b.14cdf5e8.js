"use strict";(self.webpackChunkavalonia_docs=self.webpackChunkavalonia_docs||[]).push([[9247],{56946:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"porting-tips","title":"Porting Tips","description":"The following are things to watch out before starting the work to port your WPF app to XPF:","source":"@site/xpf/porting-tips.md","sourceDirName":".","slug":"/porting-tips","permalink":"/ru/xpf/porting-tips","draft":false,"unlisted":false,"editUrl":"https://github.com/AvaloniaUI/avalonia-docs/tree/main/xpf/porting-tips.md","tags":[],"version":"current","frontMatter":{"id":"porting-tips","title":"Porting Tips"},"sidebar":"documentationSidebar","previous":{"title":"Getting started","permalink":"/ru/xpf/getting-started"},"next":{"title":"XPF Versioning","permalink":"/ru/xpf/build-feeds"}}');var n=s(74848),i=s(28453);const r={id:"porting-tips",title:"Porting Tips"},a=void 0,l={},d=[{value:"Project Files",id:"project-files",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Windows",id:"windows",level:2},{value:"Resources &amp; Settings",id:"resources--settings",level:2},{value:"Filesystem Access",id:"filesystem-access",level:2},{value:"Unsupported Controls",id:"unsupported-controls",level:2}];function c(e){const t={a:"a",code:"code",em:"em",h2:"h2",li:"li",ol:"ol",p:"p",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.p,{children:["The following are things to watch out ",(0,n.jsx)(t.em,{children:"before"})," starting the work to port your WPF app to XPF:"]}),"\n",(0,n.jsx)(t.h2,{id:"project-files",children:"Project Files"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Convert all projects to .NET 7.0 and above. The old project file format that precedes the new ",(0,n.jsx)(t.a,{href:"https://web.archive.org/web/20230712075209/https://learn.microsoft.com/en-us/dotnet/core/project-sdk/overview",children:".NET SDK style csproj"})," will not work outside of Windows."]}),"\n",(0,n.jsxs)(t.li,{children:["We highly recommend doing (1) on Windows first to avoid having to wrangle with hard to debug windows-specific dependency issues on other platforms. Please try to replace or remove deprecated features from .NET 7.0 such as AppDomain, CodeDOM, WCF, ",(0,n.jsx)(t.code,{children:"System.Web"}),", XmlSerializer, and hard Windows-only API\u2019s like ",(0,n.jsx)(t.code,{children:"System.Management.Instrumentation"}),", ",(0,n.jsx)(t.code,{children:"System.Drawing.Common"})," etc. on your app with cross-platform friendly alternatives."]}),"\n",(0,n.jsxs)(t.li,{children:["While doing (1), watch out for any custom MSBuild Tasks that your app may have. Make sure any said Tasks still work on .NET 7.0 by running ",(0,n.jsx)(t.code,{children:"dotnet build"}),". Don\u2019t test inside Visual Studio so that you can confirm it works outside."]}),"\n",(0,n.jsxs)(t.li,{children:["Convert all PCL (Portable Class Libraries) into ",(0,n.jsx)(t.code,{children:"netstandard"})," libraries."]}),"\n",(0,n.jsxs)(t.li,{children:["Remove any ",(0,n.jsx)(t.code,{children:"ApplicationDefinition"})," entries from the ",(0,n.jsx)(t.code,{children:".csproj"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:["Remove ",(0,n.jsx)(t.code,{children:"PropertyGroup"})," elements that look like ",(0,n.jsx)(t.a,{href:"https://github.com/microsoft/WPF-Samples/blob/main/Clipboard/ClipboardViewer/ClipboardViewer.csproj#L7-L18",children:"this"})," and use the default configuration provided by the SDK where possible"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,n.jsxs)(t.ol,{start:"7",children:["\n",(0,n.jsxs)(t.li,{children:["If you had a .NET Framework-based nuget package, please try to find a newer version (",(0,n.jsx)(t.code,{children:"netstandard2.0"}),", ",(0,n.jsx)(t.code,{children:"netcoreapp2.0"}),"+, ",(0,n.jsx)(t.code,{children:"net5.0"}),"+) of said package. Most of the time even those .NET Framework packages work cross platform too but it\u2019s not a guarantee."]}),"\n",(0,n.jsxs)(t.li,{children:["If there are ",(0,n.jsx)(t.code,{children:"Reference"})," items that are linked to a standalone ",(0,n.jsx)(t.code,{children:"dll"})," on your app's project file, try to find an alternative for it on NuGet as described on (4). If it\u2019s a managed assembly then often times it will work but again, no guarantee."]}),"\n",(0,n.jsxs)(t.li,{children:["If you have any native binaries, please try to find a managed equivalent or, if you have the sources for those native bins: try to recompile them to the target platforms you desire. Make sure to use ",(0,n.jsx)(t.a,{href:"https://web.archive.org/web/20230326113052/https://developers.redhat.com/blog/2019/09/06/interacting-with-native-libraries-in-net-core-3-0",children:"NativeLibrary APIs"})," to interop to those afterwards."]}),"\n",(0,n.jsx)(t.li,{children:"We recommend updating your dependencies to the latest version; especially 3rd party components such as Actipro, DevExpress, Syncfusion, Telerik etc."}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"windows",children:"Windows"}),"\n",(0,n.jsxs)(t.ol,{start:"11",children:["\n",(0,n.jsx)(t.li,{children:"We discourage any form of custom chrome window controls (e.g. WPF's WindowChrome, MahApps's MetroWindow, DevExpress's DXWindow) and anything that customizes window borders or behaviors because it\u2019s not guaranteed to fit into the target platform\u2019s UI design (e.g., a custom MetroWindow on a macOS). The best design for XPF target platforms is single view app (e.g., like a website or a mobile application)."}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"resources--settings",children:"Resources & Settings"}),"\n",(0,n.jsxs)(t.ol,{start:"12",children:["\n",(0,n.jsxs)(t.li,{children:["Resource Files (",(0,n.jsx)(t.code,{children:".resx"}),") don't get regenerated outside of Visual Studio. We suggest making use of alternatives to localization like JSON files etc. or other solutions that works independently of Visual Studio. (Subject to review once .NET 8.0 is out)"]}),"\n",(0,n.jsx)(t.li,{children:"Visual Studio Text Templates (T4, *.template files) are also deprecated on .NET 7.0. Please use source generators as an alternative."}),"\n",(0,n.jsxs)(t.li,{children:["Images or Bitmaps in Resource Files (",(0,n.jsx)(t.code,{children:".resx"}),") are not compatible with the .NET 7.0: consider using WPF's resources scheme instead."]}),"\n",(0,n.jsxs)(t.li,{children:["Avoid using ",(0,n.jsx)(t.code,{children:"App.Config"})," / ",(0,n.jsx)(t.code,{children:"System.Configuration.ConfigurationManager"})," due to it not persisting correctly on platforms that doesn\u2019t allow writes on the same location as the executing assembly (macOS, mobile, WASM, etc.) and use a 3rd party/in-house solution to write persistent configuration data for your apps."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"filesystem-access",children:"Filesystem Access"}),"\n",(0,n.jsxs)(t.ol,{start:"16",children:["\n",(0,n.jsxs)(t.li,{children:["Make sure that your file access code can handle case-sensitive filesystems and uses ",(0,n.jsx)(t.code,{children:"Path.DirectorySeparatorChar"})," instead of hardcoding the directory separators."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"unsupported-controls",children:"Unsupported Controls"}),"\n",(0,n.jsxs)(t.ol,{start:"17",children:["\n",(0,n.jsx)(t.li,{children:"Avoid using WPF's Spell checking and XPS features since those are not supported by XPF."}),"\n",(0,n.jsx)(t.li,{children:"If you have any advanced & specialized WPF features that you want to work on your app like Shaders, 3D, Media, etc., Please contact us so that we can help you figure out the best way forward."}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>a});var o=s(96540);const n={},i=o.createContext(n);function r(e){const t=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),o.createElement(i.Provider,{value:t},e.children)}}}]);